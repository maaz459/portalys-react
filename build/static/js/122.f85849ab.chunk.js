"use strict";(self.webpackChunkportalys=self.webpackChunkportalys||[]).push([[122],{69122:function(t,e,n){n.r(e),n.d(e,{PhantomAdapter:function(){return k}});var r=n(15861),i=n(15671),a=n(43144),o=n(97326),c=n(11752),s=n(60136),u=n(82963),l=n(61120),h=n(4942),p=n(64687),f=n.n(p),d=n(95437),v=n(34726),w=n(63823);function y(t,e,n){return new Promise((function(i,a){n>0?setTimeout((0,r.Z)(f().mark((function r(){var o;return f().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t();case 2:(o=r.sent)&&i(o),o||y(t,e,n-1).then((function(t){return i(t),t})).catch((function(t){return a(t)}));case 5:case"end":return r.stop()}}),r)}))),e):i(!1)}))}var m=function(){var t=(0,r.Z)(f().mark((function t(){var e,n,r=arguments;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.length>0&&void 0!==r[0]?r[0]:{interval:1e3,count:3},!("undefined"!==typeof window&&!(null===(e=window.solana)||void 0===e||!e.isPhantom))){t.next=4;break}return t.abrupt("return",window.solana);case 4:return t.next=6,y((function(){var t;return null===(t=window.solana)||void 0===t?void 0:t.isPhantom}),n.interval,n.count);case 6:if(!t.sent){t.next=9;break}return t.abrupt("return",window.solana);case 9:return t.abrupt("return",null);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();function Z(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,l.Z)(t);if(e){var i=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.Z)(this,n)}}var k=function(t){(0,s.Z)(n,t);var e=Z(n);function n(){var t;(0,i.Z)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return t=e.call.apply(e,[this].concat(a)),(0,h.Z)((0,o.Z)(t),"name",d.rW.PHANTOM),(0,h.Z)((0,o.Z)(t),"adapterNamespace",d.yk.SOLANA),(0,h.Z)((0,o.Z)(t),"currentChainNamespace",d.EN.SOLANA),(0,h.Z)((0,o.Z)(t),"type",d.hN.EXTERNAL),(0,h.Z)((0,o.Z)(t),"status",d.MP.NOT_READY),(0,h.Z)((0,o.Z)(t),"_wallet",null),(0,h.Z)((0,o.Z)(t),"phantomProvider",null),(0,h.Z)((0,o.Z)(t),"_onDisconnect",(function(){t._wallet&&(t._wallet.off("disconnect",t._onDisconnect),t.rehydrated=!1,t.status=t.status===d.MP.CONNECTED?d.MP.READY:d.MP.NOT_READY,t.emit(d.n2.DISCONNECTED))})),t}return(0,a.Z)(n,[{key:"isWalletConnected",get:function(){var t;return!(null===(t=this._wallet)||void 0===t||!t.isConnected||this.status!==d.MP.CONNECTED)}},{key:"provider",get:function(){var t;return(null===(t=this.phantomProvider)||void 0===t?void 0:t.provider)||null},set:function(t){throw new Error("Not implemented")}},{key:"init",value:function(){var t=(0,r.Z)(f().mark((function t(e){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c.Z)((0,l.Z)(n.prototype),"init",this).call(this,e);case 2:return(0,c.Z)((0,l.Z)(n.prototype),"checkInitializationRequirements",this).call(this),t.next=5,m({interval:500,count:3});case 5:if(this._wallet=t.sent,this._wallet){t.next=8;break}throw d.Ty.notInstalled();case 8:if(this.phantomProvider=new w.PhantomInjectedProvider({config:{chainConfig:this.chainConfig}}),this.status=d.MP.READY,this.emit(d.n2.READY,d.rW.PHANTOM),t.prev=11,d.cM.debug("initializing phantom adapter"),!e.autoConnect){t.next=17;break}return this.rehydrated=!0,t.next=17,this.connect();case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(11),d.cM.error("Failed to connect with cached phantom provider",t.t0),this.emit("ERRORED",t.t0);case 23:case"end":return t.stop()}}),t,this,[[11,19]])})));return function(e){return t.apply(this,arguments)}}()},{key:"connect",value:function(){var t=(0,r.Z)(f().mark((function t(){var e,i=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(0,c.Z)((0,l.Z)(n.prototype),"checkConnectionRequirements",this).call(this),this.status=d.MP.CONNECTING,this.emit(d.n2.CONNECTING,{adapter:d.rW.PHANTOM}),this._wallet){t.next=6;break}throw d.Ty.notInstalled();case 6:if(this._wallet.isConnected){t.next=23;break}return e=this._wallet._handleDisconnect,t.prev=8,t.next=11,new Promise((function(t,n){var a=function(){var e=(0,r.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.connectWithProvider(i._wallet);case 2:t(i.provider);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();i._wallet?(i._wallet.once("connect",a),i._wallet._handleDisconnect=function(){n(d.Ty.windowClosed());for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.apply(i._wallet,r)},i._wallet.connect().catch((function(t){n(t)}))):n(d.Ty.notInstalled())}));case 11:t.next=18;break;case 13:if(t.prev=13,t.t0=t.catch(8),!(t.t0 instanceof d.up)){t.next=17;break}throw t.t0;case 17:throw d.RM.connectionError(null===t.t0||void 0===t.t0?void 0:t.t0.message);case 18:return t.prev=18,this._wallet._handleDisconnect=e,t.finish(18);case 21:t.next=25;break;case 23:return t.next=25,this.connectWithProvider(this._wallet);case 25:if(this._wallet.publicKey){t.next=27;break}throw d.RM.connectionError();case 27:return this._wallet.on("disconnect",this._onDisconnect),t.abrupt("return",this.provider);case 31:throw t.prev=31,t.t1=t.catch(0),this.status=d.MP.READY,this.rehydrated=!1,this.emit(d.n2.ERRORED,t.t1),t.t1;case 37:case"end":return t.stop()}}),t,this,[[0,31],[8,13,18,21]])})));return function(){return t.apply(this,arguments)}}()},{key:"disconnect",value:function(){var t=(0,r.Z)(f().mark((function t(){var e,r,i=arguments;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:{cleanup:!1},t.next=3,(0,c.Z)((0,l.Z)(n.prototype),"disconnectSession",this).call(this);case 3:return t.prev=3,t.next=6,null===(r=this._wallet)||void 0===r?void 0:r.disconnect();case 6:return e.cleanup&&(this.status=d.MP.NOT_READY,this.phantomProvider=null,this._wallet=null),t.next=9,(0,c.Z)((0,l.Z)(n.prototype),"disconnect",this).call(this);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),this.emit(d.n2.ERRORED,d.RM.disconnectionError(null===t.t0||void 0===t.t0?void 0:t.t0.message));case 14:case"end":return t.stop()}}),t,this,[[3,11]])})));return function(){return t.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var t=(0,r.Z)(f().mark((function t(){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isWalletConnected){t.next=2;break}throw d.RM.notConnectedError("Not connected with wallet, Please login/connect first");case 2:return t.abrupt("return",{});case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"connectWithProvider",value:function(){var t=(0,r.Z)(f().mark((function t(e){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.phantomProvider){t.next=2;break}throw d.RM.connectionError("No phantom provider");case 2:return t.next=4,this.phantomProvider.setupProvider(e);case 4:return this.status=d.MP.CONNECTED,this.emit(d.n2.CONNECTED,{adapter:d.rW.PHANTOM,reconnected:this.rehydrated}),t.abrupt("return",this.provider);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}(v.v)}}]);
//# sourceMappingURL=122.f85849ab.chunk.js.map